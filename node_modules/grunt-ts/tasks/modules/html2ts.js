var _ = require('underscore');
var fs = require('fs');
var path = require('path');

var escapeContent = function (content, quoteChar) {
    if (typeof quoteChar === "undefined") { quoteChar = '\''; }
    var quoteRegexp = new RegExp('\\' + quoteChar, 'g');
    var nlReplace = '';
    return content.replace(quoteRegexp, '\\' + quoteChar).replace(/\r?\n/g, nlReplace);
};

function stripBOM(str) {
    return 0xFEFF === str.charCodeAt(0) ? str.substring(1) : str;
}

var htmlTemplate = _.template('module <%= modulename %> { export var <%= varname %> =  \'<%= content %>\' } ');

function compileHTML(filename) {
    var htmlContent = escapeContent(fs.readFileSync(filename).toString());
    htmlContent = stripBOM(htmlContent);

    var ext = path.extname(filename);
    var extFreename = path.basename(filename, ext);
    var fileContent = htmlTemplate({ modulename: extFreename, varname: ext.replace('.', ''), content: htmlContent });

    var outputfile = filename + '.ts';

    fs.writeFileSync(outputfile, fileContent);
    return outputfile;
}
exports.compileHTML = compileHTML;
//# sourceMappingURL=html2ts.js.map
